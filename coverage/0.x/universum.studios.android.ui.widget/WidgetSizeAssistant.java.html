<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>WidgetSizeAssistant.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=0;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">debugAndroidTest</a> &gt; <a href="index.source.html" class="el_package">universum.studios.android.ui.widget</a> &gt; <span class="el_source">WidgetSizeAssistant.java</span></div><h1>WidgetSizeAssistant.java</h1><pre class="source lang-java linenums">/*
 * =================================================================================================
 *                             Copyright (C) 2017 Universum Studios
 * =================================================================================================
 *         Licensed under the Apache License, Version 2.0 or later (further &quot;License&quot; only).
 * -------------------------------------------------------------------------------------------------
 * You may use this file only in compliance with the License. More details and copy of this License 
 * you may obtain at
 * 
 * 		http://www.apache.org/licenses/LICENSE-2.0
 * 
 * You can redistribute, modify or publish any part of the code written within this file but as it 
 * is described in the License, the software distributed under the License is distributed on an 
 * &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES or CONDITIONS OF ANY KIND.
 * 
 * See the License for the specific language governing permissions and limitations under the License.
 * =================================================================================================
 */
package universum.studios.android.ui.widget;

import android.animation.Animator;
import android.animation.ValueAnimator;
import android.util.Log;
import android.view.View;
import android.view.ViewGroup;

import universum.studios.android.ui.UiConfig;

/**
 * todo: description
 *
 * @author Martin Albedinsky
 */
final class WidgetSizeAssistant {

	// fixme: move some logic from here to WidgetSizeAnimator

	/**
	 * Interface ===================================================================================
	 */

	/**
	 * Constants ===================================================================================
	 */

	/**
	 * Log TAG.
	 */
	private static final String TAG = &quot;ViewSizeAssistant&quot;;

	/**
	 * Flag indicating whether the output trough log-cat is enabled or not.
	 */
	// private final boolean LOG_ENABLED = true;

	/**
	 * Flag indicating whether the debug output trough log-cat is enabled or not.
	 */
<span class="nc" id="L59">	private final boolean DEBUG_ENABLED = UiConfig.DEBUG_LOG_ENABLED;</span>

	/**
	 * Static members ==============================================================================
	 */

	/**
	 * Members =====================================================================================
	 */

	/**
	 *
	 */
	PendingAnimation mPendingAnimation;

	/**
	 *
	 */
	private final View mView;

	/**
	 *
	 */
	private final ViewGroup.LayoutParams mViewParams;

	/**
	 *
	 */
	private final ViewInfo mViewInfo;

	/**
	 *
	 */
	private SizeAnimator mSizeAnimator;

	/**
	 *
	 */
	private boolean mAnimationRunning;

	/**
	 * Constructors ================================================================================
	 */

	/**
	 *
	 * @param view
	 */
<span class="nc" id="L107">	public WidgetSizeAssistant(View view) {</span>
<span class="nc bnc" id="L108" title="All 2 branches missed.">		if (view == null) {</span>
<span class="nc" id="L109">			throw new NullPointerException(&quot;Invalid view.&quot;);</span>
		}
<span class="nc" id="L111">		this.mView = view;</span>
<span class="nc" id="L112">		this.mViewParams = view.getLayoutParams();</span>
<span class="nc" id="L113">		this.mViewInfo = new ViewInfo(view);</span>
		/**
		 * Resolve preferred view height.
		 */
<span class="nc" id="L117">		final int width = view.getWidth();</span>
<span class="nc" id="L118">		final int height = view.getHeight();</span>
<span class="nc bnc" id="L119" title="All 4 branches missed.">		if (width &gt; 0 &amp;&amp; height &gt; 0) {</span>
<span class="nc" id="L120">			mViewInfo.preferredWidth = width;</span>
<span class="nc" id="L121">			mViewInfo.preferredHeight = height;</span>
		}

		/**
		 * Resolve view collapsible state.
		 */
<span class="nc bnc" id="L127" title="All 2 branches missed.">		final boolean visibilityGone = mView.getVisibility() == View.GONE;</span>
		/*this.bCollapsedHorizontally = mPreferredWidth == 0 || visibilityGone;
		this.bCollapsedVertically = mPreferredHeight == 0 || visibilityGone;*/

<span class="nc bnc" id="L131" title="All 2 branches missed.">		if (visibilityGone) {</span>
			//final float originalAlpha = mView.getAlpha();
<span class="nc" id="L133">			mView.addOnLayoutChangeListener(new View.OnLayoutChangeListener() {</span>
				@Override
				public void onLayoutChange(View v, int left, int top, int right, int bottom, int oldLeft, int oldTop, int oldRight, int oldBottom) {
<span class="nc" id="L136">					mView.removeOnLayoutChangeListener(this);</span>
<span class="nc" id="L137">					mViewInfo.preferredWidth = mView.getWidth();</span>
<span class="nc" id="L138">					mViewInfo.preferredHeight = mView.getHeight();</span>
<span class="nc" id="L139">					mView.setVisibility(View.GONE);</span>
<span class="nc" id="L140">					mViewInfo.ignoreViewInvisibility = false;</span>
					//mView.setAlpha(originalAlpha);
<span class="nc bnc" id="L142" title="All 2 branches missed.">					if (mPendingAnimation != null) {</span>
<span class="nc" id="L143">						mPendingAnimation.start();</span>
<span class="nc" id="L144">						mPendingAnimation = null;</span>
					}
<span class="nc" id="L146">				}</span>
			});
			//mView.setAlpha(0);
			// Request layout by changing visibility to find out view size.
<span class="nc" id="L150">			mViewInfo.ignoreViewInvisibility = true;</span>
<span class="nc" id="L151">			mView.setVisibility(View.INVISIBLE);</span>
		}
<span class="nc" id="L153">	}</span>

	/**
	 * Methods =====================================================================================
	 */

	/**
	 * Public --------------------------------------------------------------------------------------
	 */

	/**
	 *
	 * @return
	 */
	public SizeAnimator animateSize() {
<span class="nc bnc" id="L168" title="All 2 branches missed.">		if (mSizeAnimator == null) {</span>
<span class="nc" id="L169">			mSizeAnimator = new SizeAnimator(this);</span>
		}
<span class="nc" id="L171">		mSizeAnimator.innerRequest = false;</span>
<span class="nc" id="L172">		return mSizeAnimator;</span>
	}

	/**
	 *
	 * @param width
	 * @param height
	 * @return
	 */
	public boolean requestViewNewSize(int width, int height) {
<span class="nc" id="L182">		return this.updateViewSize(width, height);</span>
	}

	/**
	 *
	 * @param width
	 * @return
	 */
	public boolean requestViewNewWidth(int width) {
<span class="nc" id="L191">		return this.updateViewSize(width, mView.getHeight());</span>
	}

	/**
	 *
	 * @param height
	 * @return
	 */
	public boolean requestViewNewHeight(int height) {
<span class="nc" id="L200">		return this.updateViewSize(mView.getWidth(), height);</span>
	}

	/**
	 *
	 * @param desiredWidth
	 * @param desiredHeight
	 * @return
	 */
	public int[] obtainViewSize(int desiredWidth, int desiredHeight) {
<span class="nc" id="L210">		return this.measureViewInner(desiredWidth, desiredHeight);</span>
	}

	/**
	 *
	 * @param desiredHeight
	 * @return
	 */
	public int obtainViewHeight(int desiredHeight) {
<span class="nc" id="L219">		return this.measureViewInner(0, desiredHeight)[1];</span>
	}

	/**
	 *
	 * @param desiredWidth
	 * @return
	 */
	public int obtainViewWidth(int desiredWidth) {
<span class="nc" id="L228">		return this.measureViewInner(desiredWidth, 0)[0];</span>
	}

	/**
	 *
	 * @param newWidth
	 * @param newHeight
	 */
	public void dispatchViewSizeChanged(int newWidth, int newHeight) {
<span class="nc bnc" id="L237" title="All 2 branches missed.">		if (!mAnimationRunning) {</span>
<span class="nc" id="L238">			mViewInfo.preferredWidth = newWidth;</span>
<span class="nc" id="L239">			mViewInfo.preferredHeight = newHeight;</span>
		}
<span class="nc" id="L241">	}</span>

	/**
	 * Getters + Setters ---------------------------------------------------------------------------
	 */

	/**
	 *
	 * @return
	 */
	public View getView() {
<span class="nc" id="L252">		return mView;</span>
	}

	/**
	 *
	 * @return
	 */
	public boolean isViewCollapsed() {
<span class="nc bnc" id="L260" title="All 4 branches missed.">		return isViewWidthCollapsed() &amp;&amp; isViewHeightCollapsed();</span>
	}

	/**
	 *
	 * @return
	 */
	public boolean isViewWidthCollapsed() {
<span class="nc bnc" id="L268" title="All 2 branches missed.">		return mViewInfo.visibleWidth() == 0;</span>
	}

	/**
	 *
	 * @return
	 */
	public boolean isViewHeightCollapsed() {
<span class="nc bnc" id="L276" title="All 2 branches missed.">		return mViewInfo.visibleHeight() == 0;</span>
	}

	/**
	 *
	 * @return
	 */
	public boolean isViewSizeAvailable() {
<span class="nc bnc" id="L284" title="All 4 branches missed.">		return mView.getWidth() &gt; 0 &amp;&amp; mView.getHeight() &gt; 0;</span>
	}

	/**
	 *
	 * @return
	 */
	public boolean isViewHeightAvailable() {
<span class="nc bnc" id="L292" title="All 2 branches missed.">		return mView.getHeight() &gt; 0;</span>
	}

	/**
	 *
	 * @return
	 */
	public boolean isViewWidthAvailable() {
<span class="nc bnc" id="L300" title="All 2 branches missed.">		return mView.getWidth() &gt; 0;</span>
	}

	/**
	 * Protected -----------------------------------------------------------------------------------
	 */

	/**
	 *
	 */
	void dispatchAnimationStarted() {
<span class="nc" id="L311">		this.mAnimationRunning = true;</span>
<span class="nc bnc" id="L312" title="All 4 branches missed.">		if (mView.getVisibility() == View.VISIBLE &amp;&amp; isViewSizeAvailable()) {</span>
<span class="nc" id="L313">			mViewInfo.preferredWidth = mView.getWidth();</span>
<span class="nc" id="L314">			mViewInfo.preferredHeight = mView.getHeight();</span>
		}
<span class="nc" id="L316">	}</span>

	/**
	 *
	 */
	void dispatchAnimationFinished() {
<span class="nc" id="L322">		this.mAnimationRunning = false;</span>
<span class="nc bnc" id="L323" title="All 4 branches missed.">		if (mView.getVisibility() == View.VISIBLE &amp;&amp; isViewSizeAvailable()) {</span>
<span class="nc" id="L324">			mViewInfo.preferredWidth = mView.getWidth();</span>
<span class="nc" id="L325">			mViewInfo.preferredHeight = mView.getHeight();</span>
		}
<span class="nc" id="L327">	}</span>

	/**
	 * Private -------------------------------------------------------------------------------------
	 */

	/**
	 * @return
	 */
	private boolean isViewMeasured() {
<span class="nc bnc" id="L337" title="All 4 branches missed.">		return mViewParams.width &gt; 0 &amp;&amp; mViewParams.height &gt; 0;</span>
	}

	/**
	 * @param desiredWidth
	 * @param desiredHeight
	 * @return
	 */
	private int[] measureViewInner(int desiredWidth, int desiredHeight) {
<span class="nc bnc" id="L346" title="All 2 branches missed.">		if (!isViewMeasured()) {</span>
<span class="nc" id="L347">			return measureViewInner(</span>
					desiredWidth, View.MeasureSpec.UNSPECIFIED,
					desiredHeight, View.MeasureSpec.UNSPECIFIED
			);
		}
<span class="nc" id="L352">		final int[] size = new int[2];</span>
<span class="nc" id="L353">		size[0] = mView.getMeasuredWidth();</span>
<span class="nc" id="L354">		size[1] = mView.getMeasuredHeight();</span>
<span class="nc" id="L355">		return size;</span>
	}

	/**
	 * @param desiredWidth
	 * @param widthMode
	 * @param desiredHeight
	 * @param heightMode
	 * @return
	 */
	private int[] measureViewInner(int desiredWidth, int widthMode, int desiredHeight, int heightMode) {
<span class="nc" id="L366">		final int[] size = new int[2];</span>
<span class="nc" id="L367">		mView.measure(</span>
<span class="nc" id="L368">				View.MeasureSpec.makeMeasureSpec(desiredWidth, widthMode),</span>
<span class="nc" id="L369">				View.MeasureSpec.makeMeasureSpec(desiredHeight, heightMode)</span>
		);
<span class="nc" id="L371">		mView.requestLayout();</span>
<span class="nc" id="L372">		size[0] = mView.getMeasuredWidth();</span>
<span class="nc" id="L373">		size[1] = mView.getMeasuredHeight();</span>
<span class="nc bnc" id="L374" title="All 2 branches missed.">		if (DEBUG_ENABLED) {</span>
<span class="nc" id="L375">			Log.d(TAG, &quot;measureViewInner() width:&quot; + size[0] + &quot; height:&quot; + size[1]);</span>
		}
<span class="nc" id="L377">		return size;</span>
	}

	/**
	 * @param newWidth
	 * @param newHeight
	 * @return
	 */
	boolean updateViewSize(int newWidth, int newHeight) {
<span class="nc" id="L386">		boolean changed = false;</span>
<span class="nc bnc" id="L387" title="All 4 branches missed.">		if (newWidth != mView.getWidth() || newHeight != mView.getHeight()) {</span>
<span class="nc bnc" id="L388" title="All 2 branches missed.">			if (mViewParams != null) {</span>
<span class="nc" id="L389">				mViewParams.width = newWidth;</span>
<span class="nc" id="L390">				mViewParams.height = newHeight;</span>
<span class="nc" id="L391">				mView.setLayoutParams(mViewParams);</span>
<span class="nc" id="L392">				changed = true;</span>
			}
		}
<span class="nc" id="L395">		return changed;</span>
	}

	/**
	 * Abstract methods ----------------------------------------------------------------------------
	 */

	/**
	 * Inner classes ===============================================================================
	 */

	/**
	 * todo: description
	 *
	 * @author Martin Albedinsky
	 */
	public static class SizeAnimator extends ValueAnimator implements ValueAnimator.AnimatorUpdateListener, Animator.AnimatorListener {

		/**
		 * Constants ===============================================================================
		 */

		/**
		 *
		 */
		private static final int HEIGHT = 0x01;

		/**
		 *
		 */
		private static final int WIDTH = 0x02;

		/**
		 *
		 */
		private static final int RESET_ALPHA_OFFSET = 5;

		/**
		 * Members =================================================================================
		 */

		/**
		 *
		 */
<span class="nc" id="L439">		int property = 0;</span>

		/**
		 *
		 */
		boolean collapsing;

		/**
		 *
		 */
		private final ViewInfo info;

		/**
		 *
		 */
		private final WidgetSizeAssistant sizeAssistant;

		/**
		 *
		 */
		private AnimatorListener listener;

		/**
		 *
		 */
<span class="nc" id="L464">		private boolean innerRequest = false;</span>

		/**
		 *
		 */
<span class="nc" id="L469">		private float originalAlpha = 1;</span>

		/**
		 *
		 */
<span class="nc" id="L474">		private boolean resetAlpha = false;</span>

		/**
		 * Constructors ============================================================================
		 */

		/**
		 *
		 * @param assistant
		 */
<span class="nc" id="L484">		public SizeAnimator(WidgetSizeAssistant assistant) {</span>
<span class="nc" id="L485">			addListener(this);</span>
<span class="nc" id="L486">			addUpdateListener(this);</span>
<span class="nc" id="L487">			this.sizeAssistant = assistant;</span>
<span class="nc" id="L488">			this.info = assistant.mViewInfo;</span>
<span class="nc" id="L489">		}</span>

		/**
		 * Methods =================================================================================
		 */

		/**
		 *
		 * @return
		 */
		public SizeAnimator collapseHeight() {
<span class="nc" id="L500">			this.collapsing = true;</span>
<span class="nc" id="L501">			this.innerRequest = true;</span>
<span class="nc" id="L502">			this.property = HEIGHT;</span>
<span class="nc" id="L503">			setIntValues(info.visibleHeight(), 0);</span>
<span class="nc" id="L504">			return this;</span>
		}

		/**
		 *
		 * @return
		 */
		public SizeAnimator expandHeight() {
<span class="nc" id="L512">			this.collapsing = false;</span>
<span class="nc" id="L513">			this.innerRequest = true;</span>
<span class="nc" id="L514">			this.property = HEIGHT;</span>
<span class="nc" id="L515">			setIntValues(info.visibleHeight(), info.preferredHeight);</span>
<span class="nc" id="L516">			return this;</span>
		}

		/**
		 *
		 * @return
		 */
		public SizeAnimator collapseWidth() {
<span class="nc" id="L524">			this.collapsing = true;</span>
<span class="nc" id="L525">			this.innerRequest = true;</span>
<span class="nc" id="L526">			this.property = WIDTH;</span>
<span class="nc" id="L527">			setIntValues(info.preferredWidth, 0);</span>
<span class="nc" id="L528">			return this;</span>
		}

		/**
		 *
		 * @return
		 */
		public SizeAnimator expandWidth() {
<span class="nc" id="L536">			this.collapsing = false;</span>
<span class="nc" id="L537">			this.innerRequest = true;</span>
<span class="nc" id="L538">			this.property = WIDTH;</span>
<span class="nc" id="L539">			setIntValues(info.visibleWidth(), info.preferredWidth);</span>
<span class="nc" id="L540">			return this;</span>
		}

		/**
		 *
		 * @param value
		 * @return
		 */
		public SizeAnimator height(int value) {
			// todo:
			/*final int height = info.visibleHeight();
			this.collapsing = value &lt; height;
			this.innerRequest = true;
			this.property = HEIGHT;
			setIntValues(height, value);*/
<span class="nc" id="L555">			return this;</span>
		}

		/**
		 *
		 * @param value
		 * @return
		 */
		public SizeAnimator width(int value) {
			// todo:
<span class="nc" id="L565">			return this;</span>
		}

		/**
		 *
		 * @param value
		 * @return
		 */
		public SizeAnimator heightBy(int value) {
			// todo:
<span class="nc" id="L575">			return this;</span>
		}

		/**
		 *
		 * @param value
		 * @return
		 */
		public SizeAnimator widthBy(int value) {
			// todo:
<span class="nc" id="L585">			return this;</span>
		}

		/**
		 */
		@Override
		public void onAnimationUpdate(ValueAnimator animation) {
<span class="nc" id="L592">			final int value = (int) animation.getAnimatedValue();</span>
<span class="nc bnc" id="L593" title="All 3 branches missed.">			switch (property) {</span>
				case HEIGHT:
<span class="nc" id="L595">					sizeAssistant.requestViewNewHeight(value);</span>
<span class="nc" id="L596">					break;</span>
				case WIDTH:
<span class="nc" id="L598">					sizeAssistant.requestViewNewWidth(value);</span>
					break;
			}
<span class="nc bnc" id="L601" title="All 4 branches missed.">			if (resetAlpha &amp;&amp; value &gt; RESET_ALPHA_OFFSET) {</span>
<span class="nc" id="L602">				info.view.setAlpha(originalAlpha);</span>
<span class="nc" id="L603">				this.resetAlpha = false;</span>
			}
<span class="nc" id="L605">		}</span>

		/**
		 */
		@Override
		public void onAnimationStart(Animator animation) {
<span class="nc" id="L611">			sizeAssistant.dispatchAnimationStarted();</span>
<span class="nc bnc" id="L612" title="All 2 branches missed.">			if (innerRequest) {</span>
<span class="nc bnc" id="L613" title="All 4 branches missed.">				if (!collapsing &amp;&amp; info.visibility() != View.VISIBLE) {</span>
					// Do not show the view blink when changing visibility to View.VISIBLE, so
					// to hide such a behaviour we will set for initial phase of animation its
					// alpha property to 0 and than after RESET_ALPHA_OFFSET this alpha property
					// will be returned to its original value.
<span class="nc" id="L618">					this.originalAlpha = info.alpha();</span>
<span class="nc" id="L619">					info.view.setAlpha(0);</span>
<span class="nc" id="L620">					this.resetAlpha = true;</span>
<span class="nc" id="L621">					info.view.setVisibility(View.VISIBLE);</span>
				}
			}
<span class="nc bnc" id="L624" title="All 2 branches missed.">			if (listener != null) {</span>
<span class="nc" id="L625">				listener.onAnimationStart(animation);</span>
			}
<span class="nc" id="L627">		}</span>

		/**
		 */
		@Override
		public void onAnimationEnd(Animator animation) {
<span class="nc bnc" id="L633" title="All 2 branches missed.">			if (innerRequest) {</span>
<span class="nc bnc" id="L634" title="All 2 branches missed.">				if (collapsing) {</span>
<span class="nc" id="L635">					info.view.setVisibility(View.GONE);</span>
				}
<span class="nc bnc" id="L637" title="All 3 branches missed.">				switch (property) {</span>
					case HEIGHT:
<span class="nc bnc" id="L639" title="All 2 branches missed.">						if (collapsing) {</span>
<span class="nc" id="L640">							sizeAssistant.requestViewNewHeight(0);</span>
						}
						break;
					case WIDTH:
<span class="nc bnc" id="L644" title="All 2 branches missed.">						if (collapsing) {</span>
<span class="nc" id="L645">							sizeAssistant.requestViewNewWidth(0);</span>
						}
						break;
				}
			}
<span class="nc" id="L650">			sizeAssistant.dispatchAnimationFinished();</span>
<span class="nc bnc" id="L651" title="All 2 branches missed.">			if (listener != null) {</span>
<span class="nc" id="L652">				listener.onAnimationEnd(animation);</span>
			}
<span class="nc" id="L654">		}</span>

		/**
		 */
		@Override
		public void onAnimationCancel(Animator animation) {
<span class="nc" id="L660">			sizeAssistant.dispatchAnimationFinished();</span>
<span class="nc bnc" id="L661" title="All 2 branches missed.">			if (listener != null) {</span>
<span class="nc" id="L662">				listener.onAnimationCancel(animation);</span>
			}
<span class="nc" id="L664">		}</span>

		/**
		 */
		@Override
		public void onAnimationRepeat(Animator animation) {
<span class="nc bnc" id="L670" title="All 2 branches missed.">			if (listener != null) {</span>
<span class="nc" id="L671">				listener.onAnimationRepeat(animation);</span>
			}
<span class="nc" id="L673">		}</span>

		/**
		 */
		@Override
		public void setIntValues(int... values) {
<span class="nc" id="L679">			super.setIntValues(values);</span>
<span class="nc" id="L680">		}</span>

		/**
		 */
		@Override
		public void start() {
<span class="nc bnc" id="L686" title="All 2 branches missed.">			if (!collapsing) {</span>
<span class="nc bnc" id="L687" title="All 3 branches missed.">				switch (property) {</span>
					case HEIGHT:
<span class="nc bnc" id="L689" title="All 2 branches missed.">						if (info.preferredHeight == 0) {</span>
<span class="nc" id="L690">							sizeAssistant.mPendingAnimation = new PendingAnimation(this);</span>
<span class="nc" id="L691">							return;</span>
						}
						break;
					case WIDTH:
<span class="nc bnc" id="L695" title="All 2 branches missed.">						if (info.preferredWidth == 0) {</span>
<span class="nc" id="L696">							sizeAssistant.mPendingAnimation = new PendingAnimation(this);</span>
<span class="nc" id="L697">							return;</span>
						}
						break;
				}
			}
<span class="nc" id="L702">			super.start();</span>
<span class="nc" id="L703">		}</span>

		/**
		 *
		 * @param listener
		 * @return
		 */
		public SizeAnimator setListener(AnimatorListener listener) {
<span class="nc" id="L711">			this.listener = listener;</span>
<span class="nc" id="L712">			return this;</span>
		}

		/**
		 *
		 */
		void performStart() {
<span class="nc" id="L719">			super.start();</span>
<span class="nc" id="L720">		}</span>
	}

	/**
	 *
	 */
	private static class PendingAnimation {

		/**
		 * Members =================================================================================
		 */

		/**
		 *
		 */
		SizeAnimator animator;

		/**
		 * Constructors ============================================================================
		 */

		/**
		 *
		 * @param animator
		 */
<span class="nc" id="L745">		PendingAnimation(SizeAnimator animator) {</span>
<span class="nc" id="L746">			this.animator = animator;</span>
<span class="nc" id="L747">		}</span>

		/**
		 * Methods =================================================================================
		 */

		/**
		 *
		 */
		void start() {
<span class="nc" id="L757">			final boolean collapseRequest = animator.collapsing;</span>
<span class="nc bnc" id="L758" title="All 3 branches missed.">			switch (animator.property) {</span>
				case SizeAnimator.HEIGHT:
<span class="nc bnc" id="L760" title="All 2 branches missed.">					if (collapseRequest) {</span>
<span class="nc" id="L761">						animator.collapseHeight();</span>
					} else {
<span class="nc" id="L763">						animator.expandHeight();</span>
					}
<span class="nc" id="L765">					break;</span>
				case SizeAnimator.WIDTH:
<span class="nc bnc" id="L767" title="All 2 branches missed.">					if (collapseRequest) {</span>
<span class="nc" id="L768">						animator.collapseWidth();</span>
					} else {
<span class="nc" id="L770">						animator.expandWidth();</span>
					}
					break;
			}
<span class="nc" id="L774">			animator.performStart();</span>
<span class="nc" id="L775">		}</span>
	}

	/**
	 *
	 */
	private static class ViewInfo {

		/**
		 * Members =================================================================================
		 */

		/**
		 *
		 */
		final View view;

		/**
		 *
		 */
		final ViewGroup.LayoutParams viewParams;

		/**
		 *
		 */
<span class="nc" id="L800">		boolean ignoreViewInvisibility = false;</span>

		/**
		 *
		 */
		int preferredWidth, preferredHeight;

		/**
		 * Constructors ============================================================================
		 */

		/**
		 *
		 * @param view
		 */
<span class="nc" id="L815">		ViewInfo(View view) {</span>
<span class="nc" id="L816">			this.view = view;</span>
<span class="nc" id="L817">			this.viewParams = view.getLayoutParams();</span>
<span class="nc" id="L818">		}</span>

		/**
		 * Methods =================================================================================
		 */

		/**
		 *
		 * @return
		 */
		int height() {
<span class="nc" id="L829">			return view.getHeight();</span>
		}

		/**
		 *
		 * @return
		 */
		int visibleHeight() {
<span class="nc bnc" id="L837" title="All 4 branches missed.">			return (visibility() != View.GONE &amp;&amp; !ignoreViewInvisibility) ? viewParams.height : 0;</span>
		}

		/**
		 *
		 * @return
		 */
		int paramsHeight() {
<span class="nc" id="L845">			return viewParams.height;</span>
		}

		/**
		 *
		 * @return
		 */
		int width() {
<span class="nc" id="L853">			return view.getWidth();</span>
		}

		/**
		 *
		 * @return
		 */
		int visibleWidth() {
<span class="nc bnc" id="L861" title="All 4 branches missed.">			return (visibility() != View.GONE &amp;&amp; !ignoreViewInvisibility) ? viewParams.width : 0;</span>
		}

		/**
		 *
		 * @return
		 */
		int paramsWidth() {
<span class="nc" id="L869">			return viewParams.width;</span>
		}

		/**
		 *
		 * @return
		 */
		int visibility() {
<span class="nc" id="L877">			return view.getVisibility();</span>
		}

		/**
		 *
		 * @return
		 */
		float alpha() {
<span class="nc" id="L885">			return view.getAlpha();</span>
		}
	}
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.5.201505241946</span>Generated by the Android Gradle plugin 2.3.0</div></body></html>